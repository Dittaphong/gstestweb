<?phpdefined('BASEPATH') OR exit('No direct script access allowed');class teacher extends CI_Controller {	public function __construct(){		parent::__construct();		session_start();	}	public function loadpage($StrQuery)	{		//Data		$data['Result'] = $StrQuery['Result'];		$data['namepage'] = $StrQuery['namepage'];		//echo "<pre>";		// print_r($data['Result']);		//exit();		// View		$this->load->view('/Template/Header', $data);		$this->load->view($StrQuery['View']);		$this->load->view('/Template/Footer');	}	public function index()	{		//Input		$input = $_SESSION['USERCODE'];		//Array (Result, View)		$Result = $this->officermodel->OfficerInfo($input);		$StrQuery = array(			'namepage' => "ระบบสารสนเทศอาจารย์",			'Result' => $Result,			'View' => '/Teacher/Pages/OfficerProfile'		);		$_SESSION['OFFICERID']=$Result[0]['OFFICERID'];		//Generate View		$this->loadpage($StrQuery);	}	public function StudentByOfficer()	{		//Input		$input = $_SESSION['OFFICERID'];		//Array (Result, View)		// Multi Table		$StrQuery = array(			'Result' => array(				'OfficerDetail' => $this->officermodel->OfficerDetail($input),				'SBOMainThesis' => $this->studentsmodel->StudentByOfficerMainThesis($input), // วิทยานิพนย์ หลัก				'SBOCoThesis' => $this->studentsmodel->StudentByOfficerCoThesis($input), // วิทยานิพนย์ ร่วม				'SBOMainIs' =>$this->studentsmodel->StudentByOfficerMainIs($input), // ค้นคว้า หลัก				'WorkByOfficer' =>$this->officermodel->WorkByOfficer($input)			),			'namepage' => 'ภาระงานอาจารย์',			'View' => '/Teacher/Pages/StudentByOfficer'		);		//$this->debuger->prevalue($StrQuery['Result']);		// การใช้ อาเรย์ $Result['SBOMainThesis']['ชื่อฟิลด์']		//Generate View		$this->loadpage($StrQuery);	}	public function WorkByOfficer()	{		//Input		$input = $_SESSION['OFFICERID'];		//Array (Result, View)		$StrQuery = array(			'Result' => $this->officermodel->WorkByOfficer($input),			'namepage' => "ภาระงานอาจารย์",			'View' => '/Teacher/Pages/WorkByOfficer'		);		//Generate View		$this->loadpage($StrQuery);	}	public function SearchStudent()	{		//Array (Result, View)		$StrQuery = array(			'Result' => $this->studentsmodel->student_all(),			'namepage' => "ค้นหานักศึกษา",			'View' =>'Public/Student/SearchStudent'		);		//Generate View		$this->loadpage($StrQuery);	}	public function StudentNomalInfo()	{		$input = $this->uri->segment(3);		$StrQuery = array(			'Result' => $this->studentsmodel->StudentNomalInfo($input),			'View' => 'Template/StudentNomalInfo');			$this->loadpage($StrQuery);		}		public function SearchThesis()		{			//Array (Result, View)			$StrQuery = array(				'Result' => $this->studentsmodel->ThesisAll(),				'namepage' => 'ค้นหาวิทยานิพนธ์',				'View' => 'Public/Portfolio/SearchThesis'			);			//Generate View			$this->loadpage($StrQuery);		}		public function SearchResearch()		{			//Array (Result, View)			$StrQuery = array(				'Result' => $this->studentsmodel->ResearchAll(),				'namepage' => 'ค้นหางานวิจัย',				'View' => 'Template/SearchResearch'			);			//Generate View			$this->loadpage($StrQuery);		}		public function OfficerLogin()		{			$this->load->view('/Teacher/Pages/AuthenOfficer');		}		public function Officerlogout()		{			session_destroy();			redirect('home');		}		public function AuthenOfficer()		{			$input = array(				'userName' => $this->input->post('userName'),				'password' => MD5($this->input->post('password')),			);			$Authen = $this->officermodel->AuthenOfficer($input);			if(count($Authen)>0){				session_destroy();				$_SESSION['USERCODE'] = $Authen[0]['USERCODE'];				$_SESSION['GROUPTYPE'] = $Authen[0]['GROUPTYPE'];				redirect('teacher');			}			else			{				redirect('teacher');			}		}		public function changepicprofile()		{			$OFFICERID = $_SESSION['OFFICERID'];			$OFFICERCODE = $_SESSION['USERCODE'];			$file = $_FILES["image"]["tmp_name"];			$ext = pathinfo($_FILES["image"]["name"], PATHINFO_EXTENSION);			$new_file = 'img_'.$OFFICERID.'_'.$OFFICERCODE.'.'.$ext;			if( $ext == "png" || $ext == "jpg" || $ext == "PNG" || $ext == "JPG"  )			{				copy($file, "image/officer/".$new_file);			}			else			{				echo $ext;				exit();			}			$input = array(				'OFFICERID' => $OFFICERID,				'OFFICER_PIC' => $new_file			);			//echo "<pre>";			// print_r($input);			// exit();			$this->officermodel->SaveOfficerPic($input);			redirect('teacher');		}		public function searchOfficer(){			if(isset($_POST['submitBtn']) == "ค้นหา"){				$arrayName = array(										'OFFICERCODE' =>$_POST['officercode'] ,										'OFFICERNAME' =>$_POST['officername'] ,										'OFFICERSURNAME' =>$_POST['officersurname'] ,										'FACULTYID' =>$_POST['officerfacultyid'] ,										//'DEPARTMENTID' =>$_POST['officerExpert'] ,										);				$data['officerInfo'] = $this->studentsmodel->getOfficerInfo($arrayName);			}			// print_r($_POST);			// print_r($data['officerInfo']);			$data['facultyLists'] = $this->studentsmodel->facultyLists();			$data['departmentLists'] = $this->studentsmodel->departmentLists();			$data['level'] = $this->studentsmodel->levelIDLists();			//array($this->studentsmodel->studentall(),			$StrQuery = array(				'Result' => $data,				'namepage' =>'ข้อมูลอาจารย์' ,				'View' => 'Template/SearchOfficer'			);			$this->loadpage($StrQuery);		}	}