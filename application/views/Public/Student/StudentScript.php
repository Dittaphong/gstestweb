<!-- Active Main Menu --><script type="text/javascript">function fnExcelReport() {    var tab_text = '<html xmlns:x="urn:schemas-microsoft-com:office:excel">';    tab_text = tab_text + '<head><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>';    tab_text = tab_text + '<x:Name>Test Sheet</x:Name>';    tab_text = tab_text + '<x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet>';    tab_text = tab_text + '</x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body>';    tab_text = tab_text + "<table border='1px'>";    tab_text = tab_text + $('#myTable').html();    tab_text = tab_text + '</table></body></html>';    var data_type = 'data:application/vnd.ms-excel';    var ua = window.navigator.userAgent;    var msie = ua.indexOf("MSIE ");    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {        if (window.navigator.msSaveBlob) {            var blob = new Blob([tab_text], {                type: "application/csv;charset=utf-8;"            });            navigator.msSaveBlob(blob, 'Test file.xls');        }    } else {        $('#test').attr('href', data_type + ', ' + encodeURIComponent(tab_text));        $('#test').attr('download', 'Test file.xls');    }}</script><script>	var cur_state =true;	function editform(_state,_url){		if(_state =='print'){			var data = $("form").serializeObject();			$.ajax({               	type: "POST",                url: '<?php echo site_url()?>/'+_url,//Student/adviser/3',               	data: data,            	success:function(data)  {                    console.log("good")					$('input.underline[type=text]').attr('disabled',true)					printpaper()                },              	error: function () {                    console.log('fail');				}        	});			event.preventDefault();		}		if(cur_state ==true){			$('input.underline[type=text]').attr('disabled',cur_state)			cur_state = false;		}		else{				$('input.underline[type=text]').attr('disabled',cur_state)				cur_state=true;		}	}	function printpaper(){		var checkprinted =false;		var printContents = document.getElementById("printableArea").innerHTML;		var originalContents = document.body.innerHTML;		document.body.innerHTML = printContents;		window.print();		document.body.innerHTML = originalContents;		window.onafterprint = function() {			//alert(checkprinted)			checkprinted =true;		}	//	alert("gfgdf"+checkprinted)		if(checkprinted ==false){			//ถ้า user ทำการกดปุ่มปริ้นให้แสดงข้อความว่า ทำการปริ้นเรียบร้อยแล้ว			document.getElementById("printmenu").innerHTML = "<center><b>ทำการปริ้นเรียบร้อยแล้ว</b></center>"		}	//	document.getElementById("printmenu").innerHTML = "<center><b>ทำการปริ้นเรียบร้อยแล้ว</b></center>"	}	function disabledfalse(){			$('input.underline[type=text]').attr('disabled',false);			return true;	}</script><script>function filterGlobal () {    $('#example').DataTable().search(        $('#global_filter').val(),        $('#global_regex').prop('checked'),        $('#global_smart').prop('checked')    ).draw();}function modalStdInfo(stdid,stdcode){	$.ajax({       	type: "GET",        url: '<?php echo site_url()."/student/test"?>/'+stdid+'/'+stdcode,       	data: {stdid : stdid,stdcode:stdcode},       	cache: false,        type: 'json',    	success:function(data)  {        //console.log(data)        var a =jQuery.parseJSON( data );        console.log(a[0]["STUDENTCODE"])        //$(".modal-body").html()        var txt = '<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">'+              '<div class="modal-dialog">'+              '<div class="modal-content">'+                  '<div class="modal-header">'+                      '<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>'+                      '<h4 class="modal-title" id="myModalLabel">Modal title</h4>'+                  '</div>'+                  '<div class="modal-body">'+                      '<p>รหัสนักศึกษา'+a[0]["STUDENTCODE"]+'</p>'+                      '<div class="content-wrapper" >'+                        '<div class="main-content">'+                  '</div>'+                  '<div class="modal-footer">'+                      '<button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-times-circle"></i> Close</button>'+                      '<button type="button" class="btn btn-custom-primary"><i class="fa fa-check-circle"></i> Save changes</button>'+                  '</div>'+              '</div>'+              '</div>'+          '</div>';        $('#test').html(txt)      //  obj = jQuery.parseJSON(data);        //alert(data)        	$('#myModal').modal('show')        },      	error: function () {            console.log('fail');		}	});	//event.preventDefault();}function filterColumn ( i ) {    $('#example').DataTable().column( i ).search(        $('#col'+i+'_filter').val(),        $('#col'+i+'_regex').prop('checked'),        $('#col'+i+'_smart').prop('checked')    ).draw();}/* Custom filtering function which will search data in column four between two values */$.fn.dataTable.ext.search.push(    function( settings, data, dataIndex ) {        var min = parseInt( $('#min').val(), 10 );        var max = parseInt( $('#max').val(), 10 );        var age = parseFloat( data[4] ) || 0; // use data for the age column        if ( ( isNaN( min ) && isNaN( max ) ) ||             ( isNaN( min ) && age <= max ) ||             ( min <= age   && isNaN( max ) ) ||             ( min <= age   && age <= max ) )        {            return true;        }        return false;    });// $('.select2-input').select2();$(document).ready(function() {    $('#example').DataTable({    	"searching": false    });    $('#myModal').modal('show')} );$('#daterange-default').daterangepicker({    timePicker: true,    timePickerIncrement: 10,    format: 'DD/MM/YYYY h:mm A'});$('.switch-demo').bootstrapSwitch();$( "form.input-append" ).keypress(function(e) {    if ( e.which == 13 ) {        e.preventDefault();    }});$('.input-group-appendable .add-more').click(function(){    $wrapper = $(this).parents('.input-appendable-wrapper');    $lastItem = $wrapper.find('.input-group-appendable').last();    $newInput = $lastItem.clone(true);    // change attribute for new item    $count = $wrapper.find('#count').val();    $count++;    // change text input and the button    $newInput.attr('id', 'input-group-appendable' + $count);    $newInput.find('input[type="text"]').attr({        id: "field" + $count,        name: "field" + $count    });    $newInput.find('.btn').attr('id', 'btn' + $count);    $newInput.appendTo($wrapper);    //change the previous button to remove    $lastItem.find('.btn')    .removeClass('add-more btn-primary')    .addClass('btn-danger')    .text('-')    .off()    .on('click', function(){        $(this).parents('.input-group-appendable').remove();    });    $wrapper.find('#count').val($count);});$('#createPropersalBtn').click(function(){    $('#createPropersalForm').toggle('slow')});$('#createThesisISExBtn').click(function(){    $('#createThesisISExForm').toggle('slow')});</script><script>$('.add-more').click(function(){    $wrapper = $(this).parents('.input-appendable-wrapper');    $lastItem = $wrapper.find('.a').last();     $newInput = $lastItem.clone(true);     // change attribute for new item    $count = $wrapper.find('#count').val();    $count++;     // change text input and the button    $newInput.attr('id', 'a' + $count);    $newInput.find('select').attr({        id: "field" + $count,        name: "field" + $count    });     $newInput.find('.btn').attr('id', 'btn' + $count);    $newInput.appendTo($wrapper);     //change the previous button to remove    $lastItem.find('.btn')    .removeClass('add-more btn-primary')    .addClass('btn-danger')    .text('-')    .off()    .on('click', function(){        $(this).parents('.a').remove();    });     $wrapper.find('#count').val($count); });</script>